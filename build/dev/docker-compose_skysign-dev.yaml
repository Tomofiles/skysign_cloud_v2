# Brings up a full stand-alone DSS sandbox environment with locally-built dss
# and dummy-oauth InterUSS images.

# To bring up this system:
# docker-compose -f docker-compose_skysign-dev.yaml -p skysign-dev up

version: '3.7'

services:

  skysign-communication-db-for-debugging:
    container_name: skysign-communication-db
    hostname: skysign-communication-db
    build:
      context: ../../skysign-db/communication-db
      dockerfile: Dockerfile

  skysign-communication-backend-for-debugging:
    container_name: skysign-communication-backend
    hostname: skysign-communication-backend
    build:
      context: ../../communication
      dockerfile: Dockerfile
      args: 
        DB_HOST: skysign-communication-db
    depends_on:
      - skysign-communication-db-for-debugging

  skysign-communication-user-gateway-for-debugging:
    container_name: skysign-communication-user-gateway
    hostname: skysign-communication-user-gateway
    build:
      context: ../../http_gateway
      dockerfile: Dockerfile
    command: /go/bin/comm-user-gateway -backend_host skysign-communication-backend -port 8888
    ports:
      - "8888:8888"
    depends_on:
      - skysign-communication-backend-for-debugging

  skysign-communication-vehicle-gateway-for-debugging:
    container_name: skysign-communication-vehicle-gateway
    hostname: skysign-communication-vehicle-gateway
    build:
      context: ../../http_gateway
      dockerfile: Dockerfile
    command: /go/bin/comm-vehicle-gateway -backend_host skysign-communication-backend -port 8889
    ports:
      - "8889:8889"
    depends_on:
      - skysign-communication-backend-for-debugging

networks:
  default:
    ipam:
      config:
        - subnet: 192.168.5.0/24
      